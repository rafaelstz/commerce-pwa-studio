"use strict";(self.webpackChunkcommerce_pwa_studio=self.webpackChunkcommerce_pwa_studio||[]).push([[9190],{2321:function(e,t,n){n.r(t),n.d(t,{_frontmatter:function(){return m},default:function(){return h}});var a,o=n(87462),i=n(63366),r=(n(15007),n(64983)),p=n(91515),d=["components"],m={},s=(a="InlineAlert",function(e){return console.warn("Component "+a+" was not imported, exported, or provided by MDXProvider as global scope"),(0,r.mdx)("div",e)}),l={_frontmatter:m},c=p.Z;function h(e){var t=e.components,n=(0,i.Z)(e,d);return(0,r.mdx)(c,(0,o.Z)({},l,n,{components:t,mdxType:"MDXLayout"}),(0,r.mdx)("h1",{id:"custom-project-templates"},"Custom project templates"),(0,r.mdx)("p",null,"The PWA Studio ",(0,r.mdx)("a",{parentName:"p",href:"/guides/packages/buildpack/scaffolding/"},"scaffolding tool")," uses the ",(0,r.mdx)("inlineCode",{parentName:"p"},"venia-concept")," package as the default template for new storefront projects, but\nyou can use your own custom project template if it contains the necessary instructions."),(0,r.mdx)("h2",{id:"buildpack-folder"},"Buildpack folder"),(0,r.mdx)("p",null,"The presence of a ",(0,r.mdx)("inlineCode",{parentName:"p"},"create.js")," file inside a ",(0,r.mdx)("inlineCode",{parentName:"p"},"_buildpack")," directory indicates that a project can be used as a template for the scaffolding command.\nYou can see an example of this directory in the ",(0,r.mdx)("a",{parentName:"p",href:"https://github.com/magento/pwa-studio/tree/develop/packages/venia-concept/_buildpack"},(0,r.mdx)("inlineCode",{parentName:"a"},"venia-concept")," package"),"."),(0,r.mdx)("h3",{id:"the-createjs-file"},"The ",(0,r.mdx)("inlineCode",{parentName:"h3"},"create.js")," file"),(0,r.mdx)("p",null,"The ",(0,r.mdx)("inlineCode",{parentName:"p"},"create.js")," file defines a function that returns an object with ",(0,r.mdx)("inlineCode",{parentName:"p"},"ignores"),", ",(0,r.mdx)("inlineCode",{parentName:"p"},"before"),", ",(0,r.mdx)("inlineCode",{parentName:"p"},"visitor"),", and ",(0,r.mdx)("inlineCode",{parentName:"p"},"after")," properties.\nThese properties are functions that provide instructions for the buildpack ",(0,r.mdx)("inlineCode",{parentName:"p"},"create-project")," command."),(0,r.mdx)("p",null,"The function defined in ",(0,r.mdx)("inlineCode",{parentName:"p"},"create.js")," is passed in an object with the following properties:"),(0,r.mdx)("ul",null,(0,r.mdx)("li",{parentName:"ul"},(0,r.mdx)("inlineCode",{parentName:"li"},"fs")," - An instance of the ",(0,r.mdx)("a",{parentName:"li",href:"https://www.npmjs.com/package/fs-extra"},(0,r.mdx)("inlineCode",{parentName:"a"},"fs-extra")," library"),", which provides utilities for most of the common copy operations."),(0,r.mdx)("li",{parentName:"ul"},(0,r.mdx)("inlineCode",{parentName:"li"},"tasks")," - An object which provides common handlers that template developers can use for globs."),(0,r.mdx)("li",{parentName:"ul"},(0,r.mdx)("inlineCode",{parentName:"li"},"options")," - An object that contains the parameters used in the ",(0,r.mdx)("inlineCode",{parentName:"li"},"buildpack create-project")," command.")),(0,r.mdx)("p",null,"When the create project command executes, it walks the template project's directory tree and applies the instructions provided by the returned object's properties."),(0,r.mdx)("h4",{id:"ignores"},(0,r.mdx)("inlineCode",{parentName:"h4"},"ignores")),(0,r.mdx)("p",null,"The ",(0,r.mdx)("inlineCode",{parentName:"p"},"ignores")," property is an array of ",(0,r.mdx)("a",{parentName:"p",href:"https://en.wikipedia.org/wiki/Glob_(programming)"},"glob patterns"),".\nFiles that match these patterns are not processed by the create project command."),(0,r.mdx)("p",null,"Use this property to prevent the create command from processing project-specific or unimportant files."),(0,r.mdx)("h3",{id:"before"},(0,r.mdx)("inlineCode",{parentName:"h3"},"before")),(0,r.mdx)("p",null,"The ",(0,r.mdx)("inlineCode",{parentName:"p"},"before")," property defines a function that runs before the command walks the directory tree.\nUse this property to add pre-processing logic during project creation."),(0,r.mdx)("h3",{id:"visitor"},(0,r.mdx)("inlineCode",{parentName:"h3"},"visitor")),(0,r.mdx)("p",null,"The ",(0,r.mdx)("inlineCode",{parentName:"p"},"visitor")," property is a mapping object that maps a glob pattern to a file handler function.\nThe glob pattern is the map key, and the file handler function is the value associated with that key."),(0,r.mdx)("p",null,"When the project creation tool walks the directory tree, it looks for files that match each glob pattern and runs the visitor function associated with that pattern."),(0,r.mdx)("p",null,"Use this property to perform custom transformation logic on a file before copying it to the new project."),(0,r.mdx)("pre",null,(0,r.mdx)("code",{parentName:"pre",className:"language-js"},"{\n  visitor: {\n    'package.json': ({ path, targetPath, options }) => {\n      const pkg = fs.readJsonSync(path);\n      pkg.name = options.name;\n      fs.writeJsonSync(targetPath, JSON.stringify(pkg, null, 4));\n    }\n  }\n}\n")),(0,r.mdx)("p",null,"This is an example of a visitor property that targets the template project's ",(0,r.mdx)("inlineCode",{parentName:"p"},"package.json")," file and modifies its name before writing it out to the ",(0,r.mdx)("inlineCode",{parentName:"p"},"targetPath"),"."),(0,r.mdx)(s,{variant:"info",slots:"text",mdxType:"InlineAlert"}),(0,r.mdx)("p",null,"The ",(0,r.mdx)("inlineCode",{parentName:"p"},"buildpack create-project")," command does not perform the actual file copy.\nUse the convenient ",(0,r.mdx)("inlineCode",{parentName:"p"},"tasks.IGNORE")," and ",(0,r.mdx)("inlineCode",{parentName:"p"},"tasks.COPY")," handlers provided by the tool to perform common ignore and copy file tasks."),(0,r.mdx)("h3",{id:"after"},(0,r.mdx)("inlineCode",{parentName:"h3"},"after")),(0,r.mdx)("p",null,"The ",(0,r.mdx)("inlineCode",{parentName:"p"},"after")," property defines a function that runs after the command walks the directory tree.\nUse this property to add post-processing logic during project creation."))}h.isMDXComponent=!0}}]);
//# sourceMappingURL=component---src-pages-guides-packages-buildpack-project-templates-index-md-133e72ce0716db9cfbcf.js.map